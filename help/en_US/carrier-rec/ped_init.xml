<?xml version="1.0" encoding="UTF-8"?>

<!--
 *
 * This help file was generated from ped_init.sci using help_from_sci().
 *
 -->

<refentry version="5.0-subset Scilab" xml:id="ped_init" xml:lang="en"
          xmlns="http://docbook.org/ns/docbook"
          xmlns:xlink="http://www.w3.org/1999/xlink"
          xmlns:svg="http://www.w3.org/2000/svg"
          xmlns:ns3="http://www.w3.org/1999/xhtml"
          xmlns:mml="http://www.w3.org/1998/Math/MathML"
          xmlns:scilab="http://www.scilab.org"
          xmlns:db="http://docbook.org/ns/docbook">

  <refnamediv>
    <refname>ped_init</refname>
    <refpurpose>Phase error detector for BPSK / M-ASK (squaring loop) and M-PSK (<latex>$z^M$</latex> loop)</refpurpose>
  </refnamediv>


<refsynopsisdiv>
   <title>Calling Sequence</title>
   <synopsis>
   ped = ped_init(tp,M[,tc])
   
   </synopsis>
</refsynopsisdiv>

<refsection>
   <title>Parameters</title>
   <variablelist>
   <varlistentry><term>tp:</term>
      <listitem><para> Type of phase detector (can be 'psk', 'costa', 'psk-atan', 'psk-map', or 'ask')</para></listitem></varlistentry>
   <varlistentry><term>M:</term>
      <listitem><para> Number of possible symbols (<latex>$M=2^k$</latex> with <latex>$k$</latex> being the number of bits per symbol)</para></listitem></varlistentry>
   <varlistentry><term>tc:</term>
      <listitem><para> Time constant for coarse RSSI estimation (expressed in number of samples)</para></listitem></varlistentry>
   <varlistentry><term>ped:</term>
      <listitem><para> Phase error detector object. Fields are: <varname>ped.process</varname>: processing function of form <varname>[ped,dphi] = process(ped,z)</varname>, with <varname>dphi</varname>: phase error, and <varname>z</varname>: input sample, other fields are private.</para></listitem></varlistentry>
   </variablelist>
</refsection>

<refsection>
   <title>Description</title>
   <para>
This is a basic phase error detector for M-PSK (or M-ASK).
Different type of detectors are supported:
<itemizedlist>
<listitem><para><emphasis role="bold">tp = 'psk'</emphasis> The signal is exponentiated by M so as to remove the modulation, the RSSI is coarsly estimated (first order IIR filter), and then the phase error is estimated as:
<latex>$$d\phi = \frac{\mathbf{Im}\left(z^M\right)}{M \cdot \textrm{RSSI}^M}$$</latex>.
This detector is less sensible to noise as the naive atan detector.</para></listitem>
<listitem><para><emphasis role="bold">tp = 'psk-atan'</emphasis>  Arc-tangent phase detector for PSK modulation (also called 'tan-loop'), computed as:
<latex>$$d\phi = \tan^{-1}(z^M)/M$$</latex>.
Be carefull, this detector can be very unreliable at low SNR or when clock recovery is not yet done (very high artificial phase error when the signal magnitude is near 0).</para></listitem>
<listitem><para><emphasis role="bold">tp = 'psk-costa'</emphasis> Use a costa loop (works only with BPSK or QPSK).</para></listitem>
<listitem><para><emphasis role="bold">tp = 'ask'</emphasis> If M=2, then use a squaring loop (as for BPSK), otherwise, use a tan-loop.</para></listitem>
</itemizedlist>
   </para>
   <para>
<refsection><title>Example</title></refsection>
<programlisting>
// Default PED for BPSK (squaring loop)
ped = ped_init('psk',2);
n = 100;
// Test signal : varying phase error from -%pi to +%pi
phase = linspace(-%pi,%pi,n)';
z = exp(%i*phase);
// Use the PED on the signal "z"
detected_phase = ped.process(ped, z);
// Notice phase ambiguity due to the squaring
clf(); plot(phase,detected_phase);
</programlisting>
<mediaobject><imageobject><imagedata fileref="ex_ped_psk.png" format="PNG"/></imageobject><caption><para>Example of phase error detection (here squaring loop, e.g. M=2). Note the phase ambiguity of <latex>$\pi$</latex>.</para></caption></mediaobject>
</para>
</refsection>

<refsection>
   <title>See also</title>
   <simplelist type="inline">
   <member><link linkend="carrier_rec_init">carrier_rec_init</link></member>
   <member><link linkend="carrier_rec_process">carrier_rec_process</link></member>
   </simplelist>
</refsection>

<refsection>
   <title>Authors</title>
   <simplelist type="vert">
   <member>J.A., full documentation available on <ulink url="http://www.tsdconseil.fr/log/sct">http://www.tsdconseil.fr/log/sct</ulink></member>
   </simplelist>
</refsection>
</refentry>
